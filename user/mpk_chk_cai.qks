screen chk_cai

file mccompagnie         primary

file pdcaisson           designer
file pdembal_tranche     designer
file pdembal_diag        designer
file pdembal_prod_dim    designer

temporary t_compteur1    integer size 8
temporary t_compteur2    integer size 8
temporary t_compteur3    integer size 8

field ciecle of mccompagnie
field cienom of mccompagnie

procedure designer chk
begin
  while retrieving pdcaisson sequential
  begin
    let t_compteur1 = 0
    let t_compteur2 = 0
    let t_compteur3 = 0

    get pdembal_diag via ciecle                , &
                         cainumcai               &
                   using ciecle    of pdcaisson, &
                         cainumcai of pdcaisson  opt
    if accessok
    then let t_compteur1 = 1

    get pdembal_prod_dim via ciecle                , &
                             cainumcai               &
                       using ciecle    of pdcaisson, &
                             cainumcai of pdcaisson  opt
    if accessok
    then let t_compteur2 = 1

    get pdembal_tranche via ciecle                , &
                            cainumcai               &
                      using ciecle    of pdcaisson, &
                            cainumcai of pdcaisson  opt
    if accessok
    then let t_compteur3 = 1

    if t_compteur3 = 1 and (t_compteur1 = 1 or t_compteur2 = 1)
    then info = ciecle of pdcaisson + " / " + cainumcai of pdcaisson  now resp
  end
end

