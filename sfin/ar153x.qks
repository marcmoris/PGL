;/T/ Gestion des adresses d'expéditions - Validation de la destruction
;
;/P/ Programmeur..: Steeve Duguay
;    Date création: 10 janvier 1995
;
;    Description..: Cet écran vérifie si la catégorie de produit reçue en 
;                   paramètre est référée dans une autre table, pour le
;                   traitement de la destruction dans l'écran maitre.
;
;
;-------------------------------------------------------------------------------

;/V/ Écran vérifier pour le passage à l'an 2000


SCREEN ar153x NOMODE &
              ACTION LABEL " " &
              FROM 23,70 TO 23,80 &
              RECEIVING ARADRESSE_EXP, &   
                        T_FLGDEL

;-------------------------------------------------------------------------------
;
TEMPORARY T_FLGDEL CHARACTER SIZE 1 ; Flag de retour.


;-------------------------------------------------------------------------------
;
; Catégories de produits
;
FILE ARADRESSE_EXP     MASTER

;
; Définition de commande
;
FILE ARCOMMANDE        REFERENCE

;
; Définition de réquisition
;
FILE ARREQUISITION     REFERENCE

;
; Définition de soumission
;
FILE ARREQ_SOUMISSION   REFERENCE



;-------------------------------------------------------------------------------
;
;
; La procédure suivante valide si la clé est référée, si oui alors
; on indique une erreur à l'usager. Si la clé n'est pas référée dans aucune
; table alors la valeur de retour sera 1.
; 
; Note: si le verbe ERROR est activé dans la procédure INITIALIZE, le
;       reste de la procédure ne sera pas effectué.
;
;
PROCEDURE INITIALIZE
BEGIN
  
  GET ARCOMMANDE    VIA ADECLE &
                    USING ADECLE OF ARADRESSE_EXP &  
                    OPTIONAL
  IF ACCESSOK
  THEN ERROR 1484 ; Destruction annulée, l'adresse d'expédition est reférée 
                  ; dans le detail des commandes.

  GET ARREQUISITION  VIA ADECLE &
                    USING ADECLE OF ARADRESSE_EXP &  
                    OPTIONAL
  IF ACCESSOK
  THEN ERROR 1485 ; Destruction annulée, l'adresse d'expédition est reférée 
                  ; dans le detail des réquisitions.

  GET ARREQ_SOUMISSION VIA ADECLE &
                       USING ADECLE OF ARADRESSE_EXP &  
                       OPTIONAL
  IF ACCESSOK
  THEN ERROR 1486 ; Destruction annulée, l'adresse d'expédition est reférée 
                  ; dans les sousmissions.       
  ;
  ; On indique par la valeur 1, que la clé n'est pas référée.
  ;
  LET T_FLGDEL = "1"
  RETURN
END

BUILD
