;/T/ Impression de la soumission
;
;/P/ Programmeur...: Nancy Marceau
;    Date Création.: 13 juin 1994
;
;    Description...: Ce programme permet de faire l'impression des soumissions.
;
;    Paramètres....: Compagnie             (Compagnie du menu)
;                    Numéro de réquisition (Borne de début)
;                    Numéro de réquisition (Borne de fin)
;
;
;-------------------------------------------------------------------------------


USE ussetqzs NOLIST
SET PAGE LENGTH 80 WIDTH 250
SET FORMFEED


ACCESS *WAR336A  &
    ;
    ; Adresse de facturation.
    ;
  LINK CIECLE OF WAR336A &
    TO CIECLE OF MCCOMPAGNIE   &

  LINK CIECLE OF WAR336A, &
       ENTCLE OF WAR336A  &
    TO CIECLE, &
       ENTCLE OF ARENTREPOT   &

  LINK CIECLE OF WAR336A, &
       ENTCLE OF WAR336A, &
       PRDCLE OF WAR336A  &
    TO CIECLE, &
       ENTCLE, &
       PRDCLE OF VPRE_PRD   &


  LINK ADECLE    OF WAR336A  &
    TO ADECLE    OF ARADRESSE_EXP   OPTIONAL &

  LINK FOUCIECLE OF WAR336A, &
       REFCLETYP OF WAR336A, &
       FOUCLE    OF WAR336A, &
       RADCLE    OF WAR336A  &
    TO REFCIECLE, &
       REFCLETYP, &
       REFCLENUM, &
       RADCLE  OF MCREF_ADRESSE   OPTIONAL &


  LINK FOCTERESCACH &
    TO TERCLE OF VTER_DSC    OPTIONAL &


  LINK ("CMDTRP",                                    &
        CMDTRP OF WAR336A)                       &
      TO XELNOM,                                     &
         CBICLE OF VCBI_DSC   ALIAS A_CBI_CMDTRP OPTIONAL &

  LINK ("CMDFAB",                                    &
         CMDFAB OF WAR336A)                       &
      TO XELNOM,                                     &
         CBICLE OF VCBI_DSC   ALIAS A_CBI_CMDFAB OPTIONAL



;
;*** CODE ESCAPE TYPIQUE A IMP. LASER SERIE HPIII ***
;                                     deb: x  y  fin: x    y

DEFINE ESCCADRE   CHARACTER SIZE 40 = "%0BIN;SP1;PW0;pu0,1500;ea8128,7490;%0A"   ;
DEFINE ESCLNH1    CHARACTER SIZE 40 = "%0BIN;SP1;PW0;pu0,7100;ea8128,7100;%0A"   ; entete
DEFINE ESCLNV1    CHARACTER SIZE 41 = "%0BIN;SP1;PW0;pu250,1500;ea250,7100;%0A"  ; no lig.
DEFINE ESCBOITE1B CHARACTER SIZE 43 = "%0BIN;SP1;PW0;pu3636,1500;ea4250,7490;%0A"; qte
DEFINE ESCBOITE1  CHARACTER SIZE 43 = "%0BIN;SP1;PW0;pu4750,1500;ea5500,7490;%0A"; qte
DEFINE ESCBOITE2  CHARACTER SIZE 43 = "%0BIN;SP1;PW0;pu6095,0500;ea7000,7490;%0A"; prix u.
DEFINE ESCBOITE3  CHARACTER SIZE 43 = "%0BIN;SP1;PW0;pu7000,0500;ea8128,1500;%0A"; s.tot @tot
DEFINE ESCBOITE4  CHARACTER SIZE 43 = "%0BIN;SP1;PW0;pu6095,1275;ea8128,1275;%0A"; TPS
DEFINE ESCBOITE5  CHARACTER SIZE 43 = "%0BIN;SP1;PW0;pu6095,0760;ea8128,1040;%0A"; TVQ
;DEFINE ESCBOITE6  CHARACTER SIZE 43 = "%0BIN;SP1;PW0;pu2250,100;ea3850,900;%0A"  ; prj
DEFINE ESCBOITE8  CHARACTER SIZE 40 = "%0BIN;SP1;PW0;pu0,100;ea1870,1300;%0A"    ; #PO
DEFINE ESCBOITE9  CHARACTER SIZE 40 = "%0BIN;SP1;PW0;pu0,1000;ea1870,1000;%0A"   ; #PO ctr

DEFINE ESCOMBRE1  CHARACTER SIZE 42 = "*t300R*p0x792Y*c2550a110b10g2P*p0x0Y"        ; entete
DEFINE ESCOMBRE2  CHARACTER SIZE 45 = "*t300R*p1800x2558Y*c598a297b10g2P*p0x0Y"     ; total
DEFINE ESCOMBRE3  CHARACTER SIZE 40 = "*t300R*p0x2614Y*c550a94b10g2P*p0x0Y"         ; #PO

DEFINE ESCLITE    CHARACTER SIZE 15 = "(19U&l8D&k4S"  ; 12 CPS, 8 ligne/pouce
DEFINE ESCCOND    CHARACTER SIZE 15 = "(19U&l8D&k2S"  ; 16 CPS, 8 ligne/pouce
DEFINE ESCNORM    CHARACTER SIZE 15 = "(19U&l6D&k0S"  ; 10 CPS, 6 ligne/pouce

DEFINE ESCCOINSUPGAUCHE CHARACTER SIZE 5 = "*p1Y"       ; PLACER CURSEUR AU DEBUT DE LA FEUILLE
DEFINE ESCSTOT          CHARACTER SIZE 8 = "*p1855x" ; titre col DEDUCTIONS:  entete 2
;
;*** FIN CODE ESCAPE ***


DEFINE D_RADADRLIB CHARACTER SIZE 3 = "A:" IF FOULNG OF WAR336A = "F" &
                                   ELSE "To:"

DEFINE D_REQDATLIB CHARACTER SIZE 15 = "Date demandée.:" &
                                        IF FOULNG OF WAR336A = "F" ELSE &
                                       "Requested date:"

DEFINE D_REQDATREQLIB CHARACTER SIZE 15 = "Date requise..:" &
                                          IF FOULNG OF WAR336A = "F" ELSE &
                                          "Required date.:"

DEFINE D_ENTCLELIB CHARACTER SIZE 15 = "Entrepôt......:" &
                                        IF FOULNG OF WAR336A = "F" ELSE &
                                       "Warehouse.....:"

DEFINE D_CMDTRPLIB CHARACTER SIZE 18   = "Mode de transport:" &
                                         IF FOULNG OF WAR336A = "F" ELSE &
                                         "Mode of transport:"

DEFINE D_CMDFABLIB CHARACTER SIZE 18 = "Terme de commerce:" &
                                       IF FOULNG OF WAR336A = "F" ELSE &
                                       "Commercial terms.:"

DEFINE D_CMDFABLIB2 CHARACTER SIZE 4 = "T.C:" &
                                        IF FOULNG OF WAR336A = "F" ELSE &
                                        "C.T:"

DEFINE D_FOCTERESCACHLIB CHARACTER SIZE 15 = "Terme d'achat.:" &
                                             IF FOULNG OF WAR336A = "F" ELSE &
                                             "Purchase terms:"

DEFINE D_REQCLELIB CHARACTER SIZE 15 = "No.réquisition:" &
                                       IF FOULNG OF WAR336A = "F" ELSE &
                                       "Requisition no:"

DEFINE D_FACLIB CHARACTER SIZE 11 = "De........:" &
                                    IF FOULNG OF WAR336A = "F" ELSE &
                                    "From......:"

DEFINE D_EXPLIB CHARACTER SIZE 11  = "Expédier à:" &
                                     IF FOULNG OF WAR336A = "F" ELSE  &
                                    "Ship to...:"

DEFINE D_CMANOMLIB CHARACTER SIZE 40 = "              I D E M            " &
                                      IF    FOULNG OF WAR336A = "F" &
                                        AND ADENOM OF ARADRESSE_EXP= "" ELSE &
                                       "              S A M E            " &
                                      IF    FOULNG OF WAR336A = "A" &
                                        AND ADENOM OF ARADRESSE_EXP= "" ELSE &
                                      ENTNOMABR OF ARENTREPOT

DEFINE D_LIBQTE1 CHARACTER SIZE 8  = "QUANTITE" &
                                    IF FOULNG OF WAR336A = "F" ELSE &
                                    "ORDERED"

DEFINE D_LIBQTE2 CHARACTER SIZE 8  = "DEMANDEE" &
                                     IF FOULNG OF WAR336A = "F" ELSE &
                                     "QUANTITY"

DEFINE D_LIBTAXTPS CHARACTER SIZE 2 = "TF" &
                                      IF FOULNG OF WAR336A = "F" ELSE &
                                      "FT"

DEFINE D_LIBTAXTVQ CHARACTER SIZE 2 = "TP" &
                                      IF FOULNG OF WAR336A = "F" ELSE &
                                      "PT"

DEFINE D_DATLIV1 CHARACTER SIZE 9 = "  DATE   " &
                                   IF FOULNG OF WAR336A = "F" ELSE &
                                    "DELIVERY "

DEFINE D_DATLIV2 CHARACTER SIZE 9 = "LIVRAISON" &
                                   IF FOULNG OF WAR336A = "F" ELSE &
                                    "  DATE  "

DEFINE D_LIBUNI CHARACTER SIZE 5 = "UNITE" &
                                   IF FOULNG OF WAR336A = "F" ELSE &
                                   "UNIT"

DEFINE D_LIBPRI1 CHARACTER SIZE 9 = "    PRIX" &
                                    IF FOULNG OF WAR336A = "F" ELSE &
                                    "    UNIT"

DEFINE D_LIBPRI2 CHARACTER SIZE 10 = "  UNITAIRE" &
                                    IF FOULNG OF WAR336A = "F" ELSE &
                                    "   PRICE "

DEFINE D_LIBTOT1 CHARACTER SIZE 9 = "    PRIX" &
                                    IF FOULNG OF WAR336A = "F" ELSE &
                                    "    TOTAL"

DEFINE D_LIBTOT2 CHARACTER SIZE 10 = "    TOTAL" &
                                    IF FOULNG OF WAR336A = "F" ELSE &
                                     "    AMOUNT"

DEFINE D_LIBSOUTOT CHARACTER SIZE 11 = " SOUS-TOTAL" &
                                       IF FOULNG OF WAR336A = "F" ELSE &
                                       "   SUBTOTAL"

DEFINE D_LIBTAXTPSTOT CHARACTER SIZE 10 = "       TPS" &
                                          IF FOULNG OF WAR336A = "F" ELSE &
                                          "       GST"

DEFINE D_LIBTAXTVQTOT CHARACTER SIZE 10 = "       TVQ" &
                                          IF FOULNG OF WAR336A = "F" ELSE &
                                          "       PST"


DEFINE D_MESSPO1  CHARACTER SIZE 27 = "   No. réquisition d'achat " &
                                      IF FOULNG OF WAR336A = "F" ELSE &
                                      "   Requisition number      "

DEFINE D_MESSPO2  CHARACTER SIZE 27 = "Ce  numéro  doit apparaître" &
                                      IF FOULNG OF WAR336A = "F" ELSE &
                                      "This number must appear on "

DEFINE D_MESSPO3  CHARACTER SIZE 27 = "sur toute  facture, corres-" &
                                      IF FOULNG OF WAR336A = "F" ELSE &
                                      "all invoices, correspondan-"

DEFINE D_MESSPO4  CHARACTER SIZE 27 = "pondance, billet de livrai-" &
                                      IF FOULNG OF WAR336A = "F" ELSE &
                                      "ces, packing slips etc..."

DEFINE D_MESSPO5  CHARACTER SIZE 27 = "son, etc..." &
                                      IF FOULNG OF WAR336A = "F" ELSE &
                                      ""

DEFINE D_CIENOM    CHARACTER SIZE 30 = CIENOM OF MCCOMPAGNIE[1:30]

DEFINE D_RADNOM CHARACTER SIZE 40 = RADNOM OF MCREF_ADRESSE[1:40]

DEFINE D_APPROUV1  CHARACTER SIZE 54 = CENTER( D_CIENOM ) &
                         IF T_FLGDRN OF WAR336A = "1" ELSE &
                         "***Suite du bon de réquisition sur la page suivante***" &
                         IF FOULNG OF WAR336A = "F" ELSE &
                         "***    Requisition continuation on next page       ***"

DEFINE D_APPROUV2  CHARACTER SIZE 54 = CENTER( "________________________________________" ) &
                                IF T_FLGDRN OF WAR336A = "1" ELSE ""

;
; Description des codes bilingues à 15 caractères.
;
DEFINE D_CBIDSC_CMDTRP CHARACTER SIZE 15 = CBIDSC OF A_CBI_CMDTRP
DEFINE D_CBIDSC_CMDFAB CHARACTER SIZE 15 = CBIDSC OF A_CBI_CMDFAB


DEFINE D_ENTETE1        CHAR SIZE 80 = CENTER(CIENOM OF MCCOMPAGNIE[1:80])
DEFINE D_ENTETE2        CHAR SIZE 80 = CENTER("   SOUMISSION   "[1:80]) &
                                      IF FOULNG OF WAR336A = "F" ELSE &
                                       CENTER("  SUBMISSSION "[1:80])


SORTED ON CIECLE    OF WAR336A            &      ; Compagnie
       ON FOUCIECLE OF WAR336A            &      ; Compagnie fournisseur
       ON FOUCLE    OF WAR336A            &      ; Numéro du fournisseur
       ON RADCLE    OF WAR336A            &      ; Adresse
       ON ADECLE    OF WAR336A RESET PAGE &      ; Adresse
       ON REQCLE    OF WAR336A            &      ; Réquisition
       ON REQCLENUM    OF WAR336A            &      ; Produit
       ON RQNSEQ    OF WAR336A

PAGE HEADING &
  ESCNORM  &
  ESCCADRE &
  ESCLNH1 &
  ESCLNV1 &
  ESCBOITE1B &
  ESCBOITE1 &
  ESCBOITE2 &
  ESCBOITE3 &
  ESCBOITE4 &
  ESCBOITE5 &
  ESCOMBRE1 &
  ESCOMBRE2 &
  ESCCOINSUPGAUCHE &
SKIP 1 &
  TAB 001 D_ENTETE1 &
SKIP 1 &
  TAB 001 D_ENTETE2 &
SKIP 2 &
  ESCLITE &

SKIP 1 &
  TAB 002 D_RADADRLIB        &
  TAB 006 FOUCLE OF WAR336A  &
  TAB 055 "Page..........:" &
  TAB 075 SYSPAGE           &

SKIP &
  TAB 006 D_RADNOM                  &
  TAB 055 D_ENTCLELIB               &
  TAB 071 ENTNOMABR OF ARENTREPOT   &

SKIP &
  TAB 006 RADADR1 OF MCREF_ADRESSE  &
  TAB 055 D_FOCTERESCACHLIB  &
  TAB 071  TERDSCABR OF VTER_DSC &

SKIP &
  TAB 006 RADADR2 OF MCREF_ADRESSE  &

SKIP &
  TAB 006 RADADR3 OF MCREF_ADRESSE &

SKIP &
  TAB 006 RADCP   OF MCREF_ADRESSE &

SKIP &
  TAB 006 "Fax:" &
  TAB 010 RADFAX  OF MCREF_ADRESSE &

SKIP 2 &
  TAB 002 D_FACLIB          &
  TAB 014 D_CIENOM          &
  TAB 050 D_EXPLIB          &
  TAB 063 D_CMANOMLIB       &

SKIP 1 &
  TAB 014 CIEADR1 OF MCCOMPAGNIE &
  TAB 063 ADENOM  OF ARADRESSE_EXP &

SKIP 1 &
  TAB 014 CIEADR2 OF MCCOMPAGNIE &
  TAB 063 ADEADR1 OF ARADRESSE_EXP &

SKIP 1 &
  TAB 014 CIEADR3 OF MCCOMPAGNIE &
  TAB 063 ADEADR2 OF ARADRESSE_EXP &

SKIP 1 &
  TAB 014 CIECP   OF MCCOMPAGNIE &
  TAB 063 ADEADR3 OF ARADRESSE_EXP &

SKIP 1 &
  TAB 063 ADECP   OF ARADRESSE_EXP &

SKIP 1 &
  ESCCOND &

SKIP 2 &
  TAB 061 D_DATLIV1 &
  TAB 081 D_LIBQTE1 &
  TAB 103 D_LIBPRI1 &
  TAB 118 D_LIBTOT1 &

SKIP &
  TAB 030 "D E S C R I P T I O N" &
  TAB 061 D_DATLIV2 &
  TAB 073 D_LIBTAXTPS &
  TAB 076 D_LIBTAXTVQ &
  TAB 081 D_LIBQTE2 &
  TAB 094 D_LIBUNI  &
  TAB 103 D_LIBPRI2 &
  TAB 118 D_LIBTOT2 &
SKIP 2


HEAD AT REQCLENUM &
  TAB 002 T_NBRLIG OF WAR336A &
    PICTURE "^^"   &
    SIGNIFICANCE 2 &
  TAB 007 PRDCLE       OF WAR336A  &
  TAB 020 REQDSC       OF WAR336A  &
  TAB 062 REQDATREQ    OF WAR336A  &
  TAB 080 REQQTEREQ    OF WAR336A  &
  TAB 094 PRDUNI       OF VPRE_PRD

REPORT &
  TAB 020 RQNDSC OF WAR336A

FOOTING AT REQCLENUM &
  TAB 020 D_REQCLELIB            &
  TAB 053  REQCLE OF WAR336A     &
          SKIP 2

FOOTING AT ADECLE &
     SKIP PAGE

PAGE FOOTING &
  TAB 103 D_LIBSOUTOT  &
SKIP 2 &
  TAB 104 D_LIBTAXTPSTOT  &
SKIP 2 &
  TAB 104 D_LIBTAXTVQTOT  &
SKIP 2 &
  TAB 044 D_APPROUV1 &
  TAB 104 "     TOTAL" &
SKIP 2 &
  TAB 036 D_APPROUV2  &
SKIP 1 &
  TAB 10 " " &
SKIP 2


BUILD ar336z
