;/T/ 2.1.1 Réservation du bloc.
;
;/P/ Programmeur..: Martin Bruyère
;    Date Création: 1994-09-06
;
;    Description..: Le but de cette unité de traitement est de gérer les
;                   rérservations du bloc.
;
;-------------------------------------------------------------------------------

;/V/ Écran vérifier pour le passage à l'an 2000


SCREEN pd177g ACTIONBAR                    &
              MODE LABEL "" AT 2,80        &
              NOACTION                     &
              ACTIVITIES FIND              &
              FIELDMARK RETAIN STARTUP     &
              HELP POPUP FROM 4,9 TO 20,72 &
              RECEIVING T_CIECLEMNU ,      &
                        T_CIENOM ,         &
                        PDBLOC

;-------------------------------------------------------------------------------
;
; Variables pour la sécurité.
;
USE ussectmp  NOLIST
    "PD177G"


;-------------------------------------------------------------------------------
;
; Documentation de l'écran.
;
USE pd177g.hlp NOLIST


;-------------------------------------------------------------------------------
;
; Actionbar standard
;
USE usactecr  NOLIST


;-------------------------------------------------------------------------------
;
; Variables saisie ou affichée dans le menu. (et utilisés dans le passage de
; paramètres).
;
TEMPORARY T_CIECLEMNU CHARACTER SIZE 4  RESET AT STARTUP ; Compagnie menu
TEMPORARY T_CIENOM    CHARACTER SIZE 40 RESET AT STARTUP ; nom compagnie


;-------------------------------------------------------------------------------
;
; Variable pour le calcul du volume d'une pièce de granit
;
use usvarvol NOLIST


;-------------------------------------------------------------------------------
;
; Bloc
;

FILE PDBLOC MASTER


;-------------------------------------------------------------------------------
;
; Réservation de bloc
;

FILE PDRESER_BLOCS PRIMARY &
                   NOITEM &
                   NODELETE &
                   NOAPPEND

  ACCESS VIA    CIECLE,          &
                BLONUMGRA001APR, &
                BLONUMGRA002APR, &
                BLORECAPR        &
         USING  T_CIECLEMNU,               &
                BLONUMGRA001APR OF PDBLOC, &
                BLONUMGRA002APR OF PDBLOC, &
                BLORECAPR       OF PDBLOC

         ITEM CIECLE OF PDRESER_BLOCS INITIAL T_CIECLEMNU

;-------------------------------------------------------------------------------
;
; Réservation
;

FILE PDRESERVATION REFERENCE

  ACCESS VIA    CIECLE,          &
                RESNUMRES        &
         USING  T_CIECLEMNU,     &
                RESNUMRES        OF PDRESER_BLOCS


;-------------------------------------------------------------------------------
;
; Numéro et nom de la compagnie pour l'en-tête de l'écran.
;
DEFINE DZ_CIECLE CHARACTER SIZE 4 = T_CIECLEMNU
DEFINE DZ_CIENOM CHARACTER SIZE 40 = CENTER( T_CIENOM )


;-------------------------------------------------------------------------------
;
;
USE usdrwecr NOLIST ; Draw pour les écrans pleine page
USE ustitstd NOLIST ; En-tête pour les écrans pleine page
USE ushilite NOLIST ; Hilite pour tout les écrans

SKIP

TITLE &
@IF FRANCAIS
      " Réservation " &
@ELSE
      " %%%Réservation " &
@ENDIF
      CENTERED AT ,1

USE ustitoff NOLIST           ; Pour placer le TITLE OFF



SKIP TO LINE 5

ALIGN (,3,19)(,23,24)(,29,30)

FIELD BLONUMGRA001APR  OF PDBLOC           &
        LABEL "No. bloc......:"            &
        DISPLAY

FIELD BLONUMGRA002APR  OF PDBLOC           &
        LABEL "-"                          &
        DISPLAY

FIELD BLORECAPR        OF PDBLOC           &
        LABEL "-"                          &
        DISPLAY


ALIGN (,3,19)

SKIP 2


FIELD RESNUMRES        OF PDRESERVATION    &
label "No reservation:"&
        DISPLAY


FIELD RESNOM           OF PDRESERVATION    &
label "Nom...........:"&
        DISPLAY


FIELD RESDSC001        OF PDRESERVATION    &
label "Description...:"&
        DISPLAY

ALIGN (,,19)


FIELD RESDSC002        OF PDRESERVATION    &
        DISPLAY


SKIP 1


ALIGN (,3,19)


FIELD RBLNUMLIG        OF PDRESER_BLOCS    &
label "No. ligne.....:"&
        DISPLAY


FIELD RBLDATRES        OF PDRESER_BLOCS     FORMAT YYYYMMDD &
PATTERN "####/##/##"&
label "Date réserv...:"&
        DISPLAY


FIELD RBLDATFIN        OF PDRESER_BLOCS     FORMAT YYYYMMDD &
PATTERN "####/##/##"&
label "Date fin......:"&
        DISPLAY


FIELD RBLFLGCLL        OF PDRESER_BLOCS    &
label "Cancellé......:"&
        DISPLAY                            &
        SIZE 3


SKIP 1


ALIGN (,3,19) (,43,59)


FIELD RESDATCRE        OF PDRESERVATION     FORMAT YYYYMMDD &
PATTERN "####/##/##"&
label "Date création.:"&
        DISPLAY


FIELD RESDATMAJ        OF PDRESERVATION     FORMAT YYYYMMDD &
PATTERN "####/##/##"&
label "Date MAJ......:"&
        DISPLAY


FIELD RESHRECRE        OF PDRESERVATION    &
label "Hre création..:"&
        DISPLAY


FIELD RESHREMAJ        OF PDRESERVATION    &
label "Hre MAJ.......:"&
        DISPLAY


FIELD RESUSRCRE        OF PDRESERVATION    &
label "Usager créat..:"&
        DISPLAY


FIELD RESUSRMAJ        OF PDRESERVATION    &
label "Usager MAJ....:"&
        DISPLAY


;-------------------------------------------------------------------------------
;
; Valide la sécurité d'accès de l'écran.
;

PROCEDURE INITIALIZE
BEGIN
  USE ussececr NOLIST
END


;-------------------------------------------------------------------------------
;
; Procédure pour convertir 1,0 en OUI,NON
;

PROCEDURE OUTPUT RBLFLGCLL
BEGIN
  USE usflgout3 NOLIST
END


;-------------------------------------------------------------------------------
;
; Valide si l'usager peut faire de la saisie.
;

PROCEDURE PREENTRY
BEGIN
  USE ussecent NOLIST
END


BUILD


@IF FORMAT

xxxx                xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx                   x
********************************* Réservation **********************************
*                                                                              *
* No. bloc......: xxxx-xxxxx-x                                                 *
*                                                                              *
*                                                                              *
* No reservation: xxxxxxxxxxx                                                  *
* Nom...........: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx                     *
* Description...: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx                     *
*                 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx                     *
*                                                                              *
* No. ligne.....: xxx                                                          *
* Date réserv...: xxxxxxxx                                                     *
* Date fin......: xxxxxxxx                                                     *
* Cancellé......: xxx                                                          *
*                                                                              *
* Date création.: xxxxxxxx                Date MAJ......: xxxxxxxx             *
* Hre création..: xxxxx                   Hre MAJ.......: xxxxx                *
* Usager créat..: xxxxxxxxxxxx            Usager MAJ....: xxxxxxxxxxxx         *
*                                                                              *
*                                                                              *
********************************************************************************
@ENDIF
