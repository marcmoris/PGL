;/T/ Module, Consultation des codes de module A METTRE À JOUR !!
;
;/P/ Prosig informatique inc.
;
;**M Source à mettre à jour
;

;/V/ Écran vérifier pour le passage à l'an 2000


SCREEN gs106 ACTIONBAR NOMODE NOACTION FIELDMARK  &
             RETAIN STARTUP HELP POPUP FROM 9,9 TO 22,72 &
             ACTIVITIES FIND &
             RECEIVING T-XMOCLE, T-XMOCOD &
             FOR 13 ON 11

USE usactecr NOLIST

TEMP T-XMOCLE    CHAR SIZE 4
TEMP T-XMOCOD   CHAR SIZE 4
TEMP T-FLAG-FIND CHAR SIZE 1 RESET AT STARTUP

;-------------------------------
DEFINE DZNOMECRAN CHAR SIZE 7  = "GS106"
DEFINE DZTITLE    CHAR SIZE 78 = "Codes de module"
;-------------------------------

FILE GSMODULE PRIMARY OCCURS 7

USE ushilite NOLIST

DRAW 2,1 TO 13,80

@IF FRANCAIS
  TITLE " Codes de module " AT 2,1 CENTERED
@ELSE
  TITLE " Module Codes " CENTERED AT 2,1
@ENDIF

SKIP

@IF FRANCAIS
    TITLE "Code Desc. française                    Desc. anglaise" AT , 5
@ELSE
    TITLE "Code French desc.                       English desc. " AT , 5
@ENDIF
SKIP 1
CLUSTER OCCURS WITH GSMODULE
 ALIGN(3,3,5)(,,10)(,,45)
 FIELD XMOCOD  OF GSMODULE LABEL " " HIDDEN
 FIELD XMOTITFRA OF GSMODULE SIZE 34
 FIELD XMOTITANG OF GSMODULE SIZE 34
CLUSTER

PROCEDURE INPUT XMOCOD
BEGIN
  IF 0 <> SIZE(TRUNC(FIELDTEXT))
  THEN LET T-FLAG-FIND = "S"
END

PROCEDURE PATH
 LET T-FLAG-FIND = "F"

PROCEDURE FIND
BEGIN
  FOR GSMODULE
    IF T-FLAG-FIND <> "S"
    THEN GET GSMODULE VIAINDEX XMO_U01 USING T-XMOCLE
    ELSE GET GSMODULE VIAINDEX XMO_U01 SEQUENTIAL
END

PROCEDURE DESIGNER 1
BEGIN
  LET T-XMOCOD = XMOCOD OF GSMODULE
  RETURN
END

BUILD
