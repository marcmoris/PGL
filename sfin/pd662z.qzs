;/T/ Liste des ventes de tranche selon la quntité à emballer
;
;/P/ Programmeur...: Martin
;    Date Création.: 1995-07-19
;
;    Description...: Liste des ventes de tranche
;
;    Paramètres....: ...
;
;    Particularités: ...
;
;-------------------------------------------------------------------------------

USE ussetqzs NOLIST

ACCESS *WPD662-LIG &

  LINK CLICIECLE        OF WPD662-LIG,&
       CLICLE           OF WPD662-LIG, &
       CIECLE           OF WPD662-LIG  &
  TO   CLICIECLE,                            &
       CLICLE,                               &
       CIECLE           OF VCLC_CLI


;-------------------------------------------------------------------------------
;
; Variables obligatoires pour les en-têtes standards.
;
DEFINE DZ_NOMRAP1 CHARACTER SIZE 60 = "Resume des ventes de tranches selon qte emballer"
DEFINE DZ_NOMRAP2 CHARACTER SIZE 60 = ""
;
; Numéro du rapport.
;
DEFINE DZ_NUMRAP  CHARACTER SIZE  7 = "PD662"
;
; Nom de la compagnie.
;
DEFINE DZ_CIENOM CHARACTER SIZE 40 = PARM

DEFINE D_TIRET     CHARACTER SIZE 01 = "-" IF D_EXPNUMEXP <> 0 ELSE " "

DEFINE D_QTE_CMD   FLOAT SIZE 08 PICTURE "^^^,^^^.^^^^" OUTPUT SCALE 4 = DCIQTECMD OF WPD662-LIG

DEFINE D_TGRDSCFRA001 CHAR SIZE 30 = TGRDSCFRA001 OF WPD662-LIG

DEFINE D_A_DCISURFACE FLOAT SIZE 8 PICTURE "^^^,^^^.^^^^" = D_SURFACE OF WPD662-LIG  IF DCIUNMCMD &
                 OF WPD662-LIG <> "TR" ELSE D_QTE_EMB OF WPD662-LIG
DEFINE D_B_DCISURFACE FLOAT SIZE 8 PICTURE "^^^,^^^.^^^^" = D_SURFACE OF WPD662-LIG  IF DCIUNMCMD &
                 OF WPD662-LIG <> "TR" ELSE D_QTE_EMB OF WPD662-LIG
DEFINE D_DCISURFACE FLOAT SIZE 8 = D_A_DCISURFACE IF DCIUNMCMD <> "TR" ELSE D_B_DCISURFACE

DEFINE D_A_DCISURFACE_EXP  FLOAT SIZE 8 PICTURE "^^^,^^^.^^^^" = D_SURFACE_EXP OF WPD662-LIG IF DCIUNMCMD &
                 OF WPD662-LIG <> "TR" ELSE D_QTE_EXP OF WPD662-LIG
DEFINE D_B_DCISURFACE_EXP  FLOAT SIZE 8 PICTURE "^^^^^^" = D_SURFACE_EXP OF WPD662-LIG IF DCIUNMCMD &
                 OF WPD662-LIG <> "TR" ELSE D_QTE_EXP OF WPD662-LIG
DEFINE D_DCISURFACE_EXP  FLOAT SIZE 8 = D_A_DCISURFACE_EXP IF DCIUNMCMD OF WPD662-LIG <> "TR" ELSE D_B_DCISURFACE_EXP

DEFINE D_A_DCIQTECMD FLOAT SIZE 8 PICTURE "^^^,^^^.^^^^" = DCIQTECMD OF WPD662-LIG
DEFINE D_B_DCIQTECMD FLOAT SIZE 8 PICTURE "^^^^^^" = DCIQTECMD OF WPD662-LIG
DEFINE D_DCIQTECMD FLOAT SIZE 8 = D_A_DCIQTECMD IF DCIUNMCMD OF WPD662-LIG <> "TR" ELSE D_B_DCIQTECMD

DEFINE D_A_QTE_A_EXP FLOAT SIZE 08  PICTURE "^^^,^^^.^^^^" = D_DCIQTECMD - D_SURFSTAT OF WPD662-LIG
DEFINE D_B_QTE_A_EXP FLOAT SIZE 08  PICTURE "^^^^^^" = D_DCIQTECMD - D_STAT OF WPD662-LIG
DEFINE D_QTE_A_EXP FLOAT SIZE 08  = D_A_QTE_A_EXP IF DCIUNMCMD OF WPD662-LIG <> "TR" ELSE D_B_QTE_A_EXP

DEFINE D_A_SURF FLOAT SIZE 8 PICTURE "^^^,^^^.^^^^"= D_SURF OF WPD662-LIG
DEFINE D_B_SURF FLOAT SIZE 8 PICTURE "^^^^^^"      = D_EMB OF WPD662-LIG
DEFINE D_C_SURF FLOAT SIZE 8 = D_A_SURF IF DCIUNMCMD OF WPD662-LIG <> "TR" ELSE D_B_SURF

DEFINE D_A_RESTE FLOAT SIZE 8 PICTURE "^^^,^^^.^^^^" = D_DCIQTECMD - D_SURF OF WPD662-LIG
DEFINE D_B_RESTE FLOAT SIZE 8 PICTURE "^^^^^^"       = D_DCIQTECMD - D_EMB  OF WPD662-LIG
DEFINE D_C_RESTE FLOAT SIZE 8 = D_A_RESTE IF DCIUNMCMD OF WPD662-LIG <> "TR" ELSE D_B_RESTE

DEFINE D_A_SURFSTAT FLOAT SIZE 8 PICTURE "^^^,^^^.^^^^"= D_SURFSTAT OF WPD662-LIG
DEFINE D_B_SURFSTAT FLOAT SIZE 8 PICTURE "^^^^^^"      = D_STAT OF WPD662-LIG
DEFINE D_C_SURFSTAT FLOAT SIZE 8 = D_A_SURFSTAT IF DCIUNMCMD OF WPD662-LIG <> "TR" ELSE D_B_SURFSTAT

DEFINE D_COMREMDATLIV001 CHAR SIZE 35 = COMREMDATLIV001 OF WPD662-LIG
DEFINE D_COMPOIMAXCAI    CHAR SIZE 35 = COMPOIMAXCAI    OF WPD662-LIG

DEFINE D_DEBBOLD        CHARACTER SIZE 05 = "[5w "
DEFINE D_FINBOLD        CHARACTER SIZE 05 = "[2w "
DEFINE D_DCICOM CHAR SIZE 20 = DCICOM OF WPD662-LIG

SORT ON COMNOM         OF WPD662-LIG &
     ON COMNUMCOM      OF WPD662-LIG &
     ON D_TGRDSCFRA001                   &
     ON TYFCODFIN      OF WPD662-LIG &
     ON DCIEPA         OF WPD662-LIG &
     ON DCINUMLIG      OF WPD662-LIG &
     ON D_CAINUMCAI    OF WPD662-LIG &
     ON D_QTE_EMB      OF WPD662-LIG


SELECT IF DCIQTECMD OF WPD662-LIG <> 0 AND  D_C_RESTE > 0


USE ustitgor200_45 NOLIST
  SKIP

HEADING AT COMNUMCOM &
;  TAB 001 "Num. commande.:" &
;  TAB 001 D_DEBBOLD &

   TAB 001 PJTABR OF WPD662-LIG &
   TAB 003 "-" &
   TAB 004 COMNUMCOMINT OF WPD662-LIG &
   TAB 008 COMNOM OF WPD662-LIG &

;  TAB 065 D_FINBOLD &
SKIP &
  TAB 001 CLINOM OF VCLC_CLI &
SKIP &
  TAB 001 "Livraison..:" &
  TAB 014 D_COMREMDATLIV001 &
  TAB 070 "Poids max..:" &
  TAB 083 D_COMPOIMAXCAI &
  SKIP 2 &
  TAB 001 "Lig Granit                                Fini   Épai     Qte cmd  UM    A emb      A exp    Description" &
  SKIP 2

HEADING AT DCINUMLIG &
  TAB 001 DCINUMLIG OF WPD662-LIG &
  TAB 005 D_TGRDSCFRA001 &
  TAB 044 TYFCODFIN OF WPD662-LIG &
  TAB 049 DCIEPA OF WPD662-LIG &
  TAB 053 D_DCIQTECMD &
  TAB 066 DCIUNMCMD OF WPD662-LIG &
  TAB 069 D_C_RESTE   &
  TAB 080 D_QTE_A_EXP &
  TAB 095 D_DCICOM &
SKIP

FOOTING AT COMNUMCOM &
 TAB 001 "------------------------------------------------------------------------------------------------------------------------------------"


BUILD pd662z

@IF FORMAT

PD999X                                                     GRANICOR INC.                                                  PAGE: 9999
AA/MM/JJ HH:MM XXXXXXXXXXXX            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

Num. commande.: XX-XXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
Num. client...: XXXXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

Granit                                   Fini  Épai      Qte cmd       Qte embal   Caisson     Qte exp     Bon livr.    Qte à exp
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  99   9999 ^^^,^^^.^^^^ XX ^^^,^^^.^^^^ 999999999 ^^^,^^^.^^^^ 999999999-99 ^^^,^^^.^^^^
                                                                   999999.9999 999999999 999999.9999  999999999-99 999999.9999
                                                                   999999.9999 999999999 999999.9999  999999999-99 999999.9999
                                                                   999999.9999 999999999 999999.9999  999999999-99 999999.9999
                                                                   999999.9999 999999999 999999.9999  999999999-99 999999.9999
                                                      Sous-total : 999999.9999 999999999 999999.9999  999999999-99 999999.9999

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  99   9999 999999.9999 XX 999999.9999 999999999 999999.9999  999999999-99 999999.9999
                                                                   999999.9999 999999999 999999.9999  999999999-99 999999.9999
                                                                   999999.9999 999999999 999999.9999  999999999-99 999999.9999
                                                                   999999.9999 999999999 999999.9999  999999999-99 999999.9999
                                                                   999999.9999 999999999 999999.9999  999999999-99 999999.9999
                                                      Sous-total : 999999.9999 999999999 999999.9999  999999999-99 999999.9999

@ENDIF
