;/T/ Solde du couru
;
;/P/ Programmeur...: Guy Chabot
;    Date Création.: 27 septembre 1994
;
;    Description...: Cette liste permet de visionner le solde du couru
;                    pour chaque réception à une période donnée.
;
;/M/                 Caroline Kaine, 11 nov 96, Format d'affichage passe de 180 
;                    a 175
;-------------------------------------------------------------------------------

USE ussetqzs NOLIST

ACCESS *WAR303B  &
   ;
   ; Pour sélectionner la devise du fournisseur.
   ;
  LINK FOUCIECLE OF WAR303B, &
       FOUCLE    OF WAR303B, &
       CIECLE    OF WAR303B  &
    TO FOUCIECLE, &
       FOUCLE,    &
       FOCCIECLE OF VFOC_FOU     &
   ; 
   ; Pour afficher le nom du fournisseur divers
   ;
  LINK FOUCIECLE OF WAR303B, &
       REFCLETYP OF WAR303B, &
       FOUCLE    OF WAR303B, &
       RADCLE    OF WAR303B  &
    TO REFCIECLE, &
       REFCLETYP, &
       REFCLENUM, &
       RADCLE OF MCREF_ADRESSE    &
   ;
   ; Pour afficher le nom de l'entrepôt
   ; 
  LINK CIECLE OF WAR303B, &
       ENTCLE OF WAR303B  &
    TO CIECLE, &
       ENTCLE OF ARENTREPOT   &
   ;
   ; Devise du consolidé
   ;
  LINK ("1") &
    TO CIENMC OF MCHOLDING   

DEFINE D_DEVCLE CHARACTER SIZE 3 = PARM          ; Devise

SELECT VFOC_FOU IF D_DEVCLE = DEVCLE OF VFOC_FOU OR D_DEVCLE = ""

SORT ON CIECLE OF WAR303B  &
     ON ENTCLE OF WAR303B  &
     ON DEVCLE OF VFOC_FOU &
     ON RECCLE OF WAR303B  &
     ON CAPCLE OF WAR303B

;
; Variables obligatoires pour les en-têtes standards.
;
DEFINE DZ_NOMRAP1 CHARACTER SIZE 60 = &
@IF FRANCAIS
       "Solde du couru"
@ELSE
       "%%%"
@ENDIF

DEFINE DZ_NOMRAP2 CHARACTER SIZE 60 = &
@IF FRANCAIS
       ""
@ELSE
       "%%%"
@ENDIF

;
; Numéro du rapport.
;
DEFINE DZ_NUMRAP  CHARACTER SIZE  7 = "AR303Z"
;
; Nom de la compagnie.
;
DEFINE DZ_CIENOM  CHARACTER SIZE 40 = PARM 

DEFINE D_RECCLE CHARACTER SIZE 4= "-" + RECCLE OF WAR303B[10:12]

DEFINE    D_DEVCLEIMP   CHARACTER SIZE 04 = " " &
          IF DEVCLE OF VFOC_FOU = DEVCLE OF MCHOLDING &
          ELSE "/" + DEVCLE OF VFOC_FOU

DEFINE  D_SOLDE FLOAT SIZE 8 = &
        RECMNTCOU    OF WAR303B - &
        RECMNTFACJOU OF WAR303B

USE ustit175 NOLIST
  SKIP 2 &
@IF FRANCAIS
TAB 001 "Devise............:" &
@ELSE
TAB 001 "%%%Devise............:" &
@ENDIF

TAB 021 DEVCLE OF VFOC_FOU    &
  SKIP &
@IF FRANCAIS
TAB 001 "Entrepôt..........:" &
@ELSE
TAB 001 "%%%Entrepôt..........:" &
@ENDIF

TAB 021 ENTCLE OF ARENTREPOT &
TAB 027 ENTNOM OF ARENTREPOT &
@IF FRANCAIS
SKIP 2  TAB 001 "Commande  No                                      ----- Dates ----- Pér.         Montant      ------------ Facture -----------         Montant           Couru            Couru" &
SKIP 1  TAB 001 "d'achat   réc  Fournisseur                    Sta Commande  Récep.  réc.        réception Dev    numéro     date    pér.  lot     couru généré         inversé   non-journalisé" &
SKIP 1  TAB 001 "                                                  aa/mm/jj aa/mm/jj                                        aa/mm/jj    " &
SKIP 1  TAB 001 "--------- --- ------------------------------- --- -------- -------- ----- --------------- --- ------------ -------- ----- ---- --------------- --------------- ----------------" &
@ELSE  
  %%%%
@ENDIF
  SKIP 1

HEADING AT DEVCLE SKIP PAGE

REPORT &
TAB 001 CMDCLE    OF WAR303B       PRINT AT RECCLE &
TAB 010 D_RECCLE                   PRINT AT RECCLE &
TAB 015 FOUCLE    OF WAR303B       PRINT AT RECCLE &
TAB 022 RADNOM    OF MCREF_ADRESSE PICTURE "^^^^^^^^^^^^^^^^^^^^^^^^^^" & PRINT AT RECCLE 
TAB 048 RECSTU    OF WAR303B       PRINT AT RECCLE &
TAB 051 CMDDAT    OF WAR303B       PRINT AT RECCLE &
TAB 060 RECDAT    OF WAR303B       PRINT AT RECCLE &
TAB 069 PECCLEACH OF WAR303B       PRINT AT RECCLE &
        PICTURE "^^-^^" &
TAB 076 RECMNTTOT OF WAR303B       PRINT AT RECCLE &
        PICTURE "^^^,^^^,^^^.^^ " TRAIL "-" &
TAB 091 D_DEVCLEIMP                PRINT AT RECCLE &
TAB 95 CAPCLE    OF WAR303B &
TAB 108 CAPDAT    OF WAR303B &
TAB 117 PECCLECAP OF WAR303B PICTURE "^^-^^" &
TAB 123 LOTCLECAP OF WAR303B PICTURE "^^^^"  &
TAB 129 RECMNTCOU OF WAR303B       PRINT AT RECCLE &
        PICTURE "^^^,^^^,^^^.^^ " TRAIL "-" BWZ &
TAB 145 RECMNTFACJOU OF WAR303B &
        PICTURE "^^^,^^^,^^^.^^ " TRAIL "-" BWZ &
TAB 161 RECMNTFACNJO OF WAR303B &
        PICTURE "^^^,^^^,^^^.^^ " TRAIL "-" BWZ &
        RESERVE 7 LINES

BUILD ar303z
@IF FORMAT
         1         2         3         4         5         6         7         8         9        10        11        12        13        14        15        16        17        18        19        20        21
1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
AR303                                                                    xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx                
99/99/99 HH:MM xxxxxxxxxxxx                                           Liste des soldes de courus pour les réceptions
                                                               xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 

Devise............: xxx
Entrepôt..........: xxxx  xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

         1         2         3         4         5         6         7         8         9        10        11        12        13        14        15        16        17        18        19        20        21
1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890

Commande  No.                                          ----- Dates ----- Pér.        Montant      ----------- Facture ------------       Montant         Couru       Couru
d'achat   réc  Fournisseur                         Sta Commande  Récep.  réc.      réception  Dev  numéro       date     pér.  lot  couru généré       inversé   non-journalisé 
--------- --- ------------------------------------ --- -------- -------- ----- -------------- --- ------------ -------- ----  ---- -------------- -------------- -------------- 
xxxxxxxxx-xxx xxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx  x  xx/xx/xx xx/xx/xx xx-xx 99,999,999.99-/xxx xxxxxxxxxxxx xx/xx/xx xx-xx xxxx 99,999,999.99- 99,999,999.99- 99,999,999.99- 
xxxxxxxxx-xxx xxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx  x  xx/xx/xx xx/xx/xx xx-xx 99,999,999.99-/xxx xxxxxxxxxxxx xx/xx/xx xx-xx xxxx 99,999,999.99- 99,999,999.99- 99,999,999.99- 
xxxxxxxxx-xxx xxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx  x  xx/xx/xx xx/xx/xx xx-xx 99,999,999.99-/xxx xxxxxxxxxxxx xx/xx/xx xx-xx xxxx 99,999,999.99- 99,999,999.99- 99,999,999.99- 
@ENDIF
