;/T/ Coûts de production (Pilotage)
;
;/P/ Programmeur..: Martin Bruyère
;    Date création: 1994-07-05
;
;    Description..: Ce panorama permet de saisir les coûts de production
;
;-------------------------------------------------------------------------------

;/V/ Écran vérifier pour le passage à l'an 2000


SCREEN pd154 ACTIONBAR                    &
             MODE LABEL "" AT 2,80        &
             NOACTION                     &
             FIELDMARK RETAIN STARTUP     &
             HELP POPUP FROM 4,9 TO 20,72 &
             RECEIVING T_CIECLEMNU ,      &
                       T_CIENOM


;-------------------------------------------------------------------------------
;
; Variables pour la sécurité.
;
USE ussectmp  NOLIST
    "PD154"


;-------------------------------------------------------------------------------
;
; Documentation de l'écran.
;
USE pd154.hlp NOLIST


;-------------------------------------------------------------------------------
;
; Actionbar standard
;
USE usactecr  NOLIST


;-------------------------------------------------------------------------------
;
; Variables saisie ou affichée dans le menu. (et utilisés dans le passage de
; paramètres).
;
TEMPORARY T_CIECLEMNU CHARACTER SIZE 4  RESET AT STARTUP ; Compagnie menu
TEMPORARY T_CIENOM    CHARACTER SIZE 40 RESET AT STARTUP ; nom compagnie


;-------------------------------------------------------------------------------
;
; Couts de production
;

FILE PDCOUT_PRODUCT PRIMARY NOITEM
  ACCESS VIA     CIECLE,&
                 CPRANN &
         USING   T_CIECLEMNU,             &
                 CPRANN OF PDCOUT_PRODUCT &
         REQUEST CPRANN OF PDCOUT_PRODUCT &
         ORDERBY CIECLE, &
                 CPRANN

  ACCESS VIA     CIECLE      &
         USING   T_CIECLEMNU &
         ORDERBY CIECLE,     &
                 CPRANN

         ITEM CIECLE OF PDCOUT_PRODUCT INITIAL T_CIECLEMNU

;-------------------------------------------------------------------------------
;
; Numéro et nom de la compagnie pour l'en-tête de l'écran.
;
DEFINE DZ_CIECLE CHARACTER SIZE 4 = T_CIECLEMNU
DEFINE DZ_CIENOM CHARACTER SIZE 40 = CENTER( T_CIENOM )


;-------------------------------------------------------------------------------
;
USE usdrwecr NOLIST ; Draw pour les écrans pleine page
USE ustitstd NOLIST ; En-tête pour les écrans pleine page
USE ushilite NOLIST ; Hilite pour tout les écrans

SKIP

TITLE &
@IF FRANCAIS
      " Coûts de production " &
@ELSE
      " %%%Coûts de production " &
@ENDIF
      CENTERED AT ,1

USE ustitoff NOLIST ; Pour placer le TITLE OFF


SKIP TO LINE 5

ALIGN (2,3,19)


FIELD CPRANN    OF PDCOUT_PRODUCT          &
        HIDDEN ID 05                       &
        REQUIRED NOCHANGE                  &
        LOOKUP NOTON PDCOUT_PRODUCT        &
          VIA   CIECLE,                    &
                CPRANN                     &
          USING T_CIECLEMNU,               &
                CPRANN OF PDCOUT_PRODUCT   &
          MESSAGE 2903 ; Cette année existe déjà


FIELD CPRCUTSCI     OF PDCOUT_PRODUCT        &
        HIDDEN ID 10                         &
        REQUIRED ; NOCHANGE


FIELD CPRCUTPOL     OF PDCOUT_PRODUCT        &
        HIDDEN ID 15                         &
        REQUIRED ;NOCHANGE


FIELD CPRCUTBRU     OF PDCOUT_PRODUCT        &
        HIDDEN ID 20                         &
        REQUIRED ;NOCHANGE


FIELD CPRCUTJOI     OF PDCOUT_PRODUCT        &
        HIDDEN ID 25                         &
        REQUIRED ;NOCHANGE


FIELD CPRPCTPTE     OF PDCOUT_PRODUCT        &
        HIDDEN ID 30                         &
        REQUIRED ;NOCHANGE


FIELD CPRFIN        OF PDCOUT_PRODUCT        &
        HIDDEN ID 35                         &
        REQUIRED ;NOCHANGE


FIELD CPREMB        OF PDCOUT_PRODUCT        &
        HIDDEN ID 40                         &
        REQUIRED ;NOCHANGE


FIELD CPRDES        OF PDCOUT_PRODUCT        &
        HIDDEN ID 45                         &
        REQUIRED ;NOCHANGE


FIELD CPREPATRTLAM  OF PDCOUT_PRODUCT        &
        HIDDEN ID 50      ;                   &
    ;    NOCHANGE


;-------------------------------------------------------------------------------
;
; Valide la sécurité d'accès de l'écran.
;

PROCEDURE INITIALIZE
BEGIN
  USE ussececr NOLIST
END


;-------------------------------------------------------------------------------
;
; Valide le nombre de décimal pour le champ : CPRCUTSCI
;

PROCEDURE EDIT CPRCUTSCI
BEGIN
  ;
  ; Valide la partie décimale.
  ;
  USE usvaldec2 NOLIST
END


;-------------------------------------------------------------------------------
;
; Valide le nombre de décimal pour le champ : CPRCUTPOL
;

PROCEDURE EDIT CPRCUTPOL
BEGIN
  ;
  ; Valide la partie décimale.
  ;
  USE usvaldec2 NOLIST
END


;-------------------------------------------------------------------------------
;
; Valide le nombre de décimal pour le champ : CPRCUTBRU
;

PROCEDURE EDIT CPRCUTBRU
BEGIN
  ;
  ; Valide la partie décimale.
  ;
  USE usvaldec2 NOLIST
END


;-------------------------------------------------------------------------------
;
; Valide le nombre de décimal pour le champ : CPRCUTJOI
;

PROCEDURE EDIT CPRCUTJOI
BEGIN
  ;
  ; Valide la partie décimale.
  ;
  USE usvaldec2 NOLIST
END


;-------------------------------------------------------------------------------
;
; Valide le nombre de décimal pour le champ : CPRPCTPTE
;

PROCEDURE EDIT CPRPCTPTE
BEGIN
  ;
  ; Valide la partie décimale.
  ;
  USE usvaldec2 NOLIST
END


;-------------------------------------------------------------------------------
;
; Valide le nombre de décimal pour le champ : CPRFIN
;

PROCEDURE EDIT CPRFIN
BEGIN
  ;
  ; Valide la partie décimale.
  ;
  USE usvaldec2 NOLIST
END


;-------------------------------------------------------------------------------
;
; Valide le nombre de décimal pour le champ : CPREMB
;

PROCEDURE EDIT CPREMB
BEGIN
  ;
  ; Valide la partie décimale.
  ;
  USE usvaldec2 NOLIST
END


;-------------------------------------------------------------------------------
;
; Valide le nombre de décimal pour le champ : CPRDES
;

PROCEDURE EDIT CPRDES
BEGIN
  ;
  ; Valide la partie décimale.
  ;
  USE usvaldec2 NOLIST
END


;-------------------------------------------------------------------------------
;
; Valide le nombre de décimal pour le champ : CPREPATRTLAM
;

PROCEDURE EDIT CPREPATRTLAM
BEGIN
  IF CPREPATRTLAM OF PDCOUT_PRODUCT < 05 OR &
     CPREPATRTLAM OF PDCOUT_PRODUCT > 99
  THEN BEGIN
    ERROR 2951; Cette valeur est hors limite ( MIN 5 mm. MAX 99 mm.)
  END
  ELSE BEGIN
    ;
    ; Valide la partie décimale.
    ;
    USE usvaldec0 NOLIST
  END
END


;-------------------------------------------------------------------------------
;
; Valide si l'usager peut faire de la saisie.
;

PROCEDURE PREENTRY
BEGIN
  USE ussecent NOLIST
END


;-------------------------------------------------------------------------------
;
; Valide les traitements permis par écran et par usager.
;

PROCEDURE PREUPDATE
BEGIN
  ;
  ; Validation de la destruction
  ;
  IF     DELETEDRECORD OF PDCOUT_PRODUCT &
     AND TZ_SECDEL = "0"
  THEN ERROR 1
  ;
  ; Validation de la modification.
  ;
  IF     ALTEREDRECORD     OF PDCOUT_PRODUCT &
     AND NOT NEWRECORD     OF PDCOUT_PRODUCT &
     AND NOT DELETEDRECORD OF PDCOUT_PRODUCT &
     AND TZ_SECMOD = "0"
  THEN ERROR 2
END

BUILD
@IF FORMAT

xxxx                xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx                   x
***************************** Coûts de production ******************************
*                                                                              *
* Année référ...: xxxx                                                         *
* Coûts sciage..: xxxxxx                                                       *
* Coûts poliss..: xxxxxx                                                       *
* Coûts brûlage.: xxxxxx                                                       *
* Coûts jointage: xxxxxx                                                       *
* Pourcent perte: xxxxxx                                                       *
* Coûts finition: xxxxxx                                                       *
* Coûts emball..: xxxxxx                                                       *
* Dessin........: xxxxxx                                                       *
* Lame scie.....: xxxxxx                                                       *
*                                                                              *
*                                                                              *
*                                                                              *
*                                                                              *
*                                                                              *
*                                                                              *
*                                                                              *
*                                                                              *
********************************************************************************
@ENDIF
