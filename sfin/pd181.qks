;/T/ Gérer les tranches
;
;/P/ Programmeur..: Martin Bruyère
;    Date Création: 1994-09-21
;
;    Description..: Le but de cette unité de traitement est de gérer
;                   l'inventaire de trache de granit de Granicor.
;
;
;
;/M/ Programmeur..: Claudie Doyon
;    Date modif...: 1999-12-07
;    Description..: Ajout des champs no.sortie et date de sortie.
;
;-------------------------------------------------------------------------------

;/V/ Écran vérifier pour le passage à l'an 2000


SCREEN pd181 ACTIONBAR                    &
             MODE LABEL "" AT 2,80        &
             NOACTION                     &
             AUTOUPDATE                   &
             ACTIVITIES FIND              &
             FIELDMARK RETAIN STARTUP     &
             HELP POPUP FROM 4,9 TO 20,72 &
             RECEIVING T_CIECLEMNU ,      &
                       T_CIENOM


;-------------------------------------------------------------------------------
;
; Variables pour la sécurité.
;



USE ussectmp  NOLIST
    "PD181"




;-------------------------------------------------------------------------------
;
; Documentation de l'écran.
;
USE pd181.hlp NOLIST


;-------------------------------------------------------------------------------
;
; Actionbar standard
;
USE usactecr  NOLIST


@IF FRANCAIS
ACTIONMENU LABEL "Sous-écrans"
  MENUITEM LABEL "Défauts de tranche              " ACTION DESIGNER D001
  MENUITEM LABEL "Bon de commande (P/O)           " ACTION DESIGNER D002
  MENUITEM LABEL "Réception                       " ACTION DESIGNER D003
  MENUITEM LABEL "Redimensionnement               " ACTION DESIGNER D004
  MENUITEM LABEL "Sciage                          " ACTION DESIGNER D005
  MENUITEM LABEL "Débitage                        " ACTION DESIGNER D006
  MENUITEM LABEL "Rejets                          " ACTION DESIGNER D007
  MENUITEM LABEL "Sorties                         " ACTION DESIGNER D008
  MENUITEM LABEL "Opération de surface            " ACTION DESIGNER D009
  MENUITEM LABEL "Facture                         " ACTION DESIGNER D010
  MENUITEM LABEL "Vérification                    " ACTION DESIGNER D011
@ELSE
ACTIONMENU LABEL "Subscreen"
  MENUITEM LABEL "%%%Défauts de tranche           " ACTION DESIGNER D001
  MENUITEM LABEL "%%%Bon de commande (P/O)        " ACTION DESIGNER D002
  MENUITEM LABEL "%%%Réception                    " ACTION DESIGNER D003
  MENUITEM LABEL "%%%Redimensionnement            " ACTION DESIGNER D004
  MENUITEM LABEL "%%%Sciage                       " ACTION DESIGNER D005
  MENUITEM LABEL "%%%Débitage                     " ACTION DESIGNER D006
  MENUITEM LABEL "%%%Rejets                       " ACTION DESIGNER D007
  MENUITEM LABEL "%%%Sorties                      " ACTION DESIGNER D008
  MENUITEM LABEL "%%%Opération de surface         " ACTION DESIGNER D009
  MENUITEM LABEL "%%%Facture                      " ACTION DESIGNER D010
  MENUITEM LABEL "%%%Vérification                 " ACTION DESIGNER D011
@ENDIF


;-------------------------------------------------------------------------------
;
; Variables saisie ou affichée dans le menu. (et utilisés dans le passage de
; paramètres).
;
TEMPORARY T_CIECLEMNU CHARACTER SIZE 4  RESET AT STARTUP ; Compagnie menu
TEMPORARY T_CIENOM    CHARACTER SIZE 40 RESET AT STARTUP ; nom compagnie


;-------------------------------------------------------------------------------
;
; Clés de recherche pour les popup de consultations et les sous écrans
;
TEMPORARY T_FOUCLE           CHARACTER SIZE 06
TEMPORARY T_FOUNO            CHARACTER SIZE 06 RESET AT STARTUP
TEMPORARY T_FOUNOM           CHARACTER SIZE 40 RESET AT STARTUP
TEMPORARY T_TRANUMTRA002     CHARACTER SIZE 07
TEMPORARY T_COD              INTEGER UNSIGNED SIZE 02


;-------------------------------------------------------------------------------
;
; Sert à valider les codes bilingue et pour les sous-écrans de consultation
;
DEFINE    D_TRASTU    CHARACTER SIZE 16 = "TRASTU"
TEMPORARY T_TRASTU    CHARACTER SIZE 04


;-------------------------------------------------------------------------------
;
; Bloc
;

FILE PDTRANCHE PRIMARY &
               NOITEM

  ACCESS VIA     CIECLE,                               &
                 TRANUMTRA002                          &
         USING   T_CIECLEMNU,                          &
                 TRANUMTRA002 OF PDTRANCHE             &
         REQUEST TRANUMTRA002 OF PDTRANCHE             &
         ORDERBY CIECLE,                               &
                 TRANUMTRA002,                         &
                 TRANUMTRA001

  ACCESS VIA     CIECLE,                               &
                 BLONUMGRA001APR,                      &
                 BLONUMGRA002APR,                      &
                 BLORECAPR                             &
         USING   T_CIECLEMNU,                          &
                 BLONUMGRA001APR OF PDTRANCHE,         &
                 BLONUMGRA002APR OF PDTRANCHE,         &
                 BLORECAPR       OF PDTRANCHE          &
         REQUEST BLONUMGRA001APR OF PDTRANCHE,         &
                 BLONUMGRA002APR OF PDTRANCHE,         &
                 BLORECAPR       OF PDTRANCHE          &
         ORDERBY CIECLE,                               &
                 TRANUMTRA002,                         &
                 TRANUMTRA001

  ACCESS VIA     CIECLE,                               &
                 BLONUMGRA001APR,                      &
                 BLONUMGRA002APR                       &
         USING   T_CIECLEMNU,                          &
                 BLONUMGRA001APR OF PDTRANCHE,         &
                 BLONUMGRA002APR OF PDTRANCHE          &
         REQUEST BLONUMGRA001APR OF PDTRANCHE,         &
                 BLONUMGRA002APR OF PDTRANCHE          &
         ORDERBY CIECLE,                               &
                 TRANUMTRA002,                         &
                 TRANUMTRA001

  ACCESS VIA     CIECLE,                               &
                 BLONUMGRA001APR                       &
         USING   T_CIECLEMNU,                          &
                 BLONUMGRA001APR OF PDTRANCHE          &
         REQUEST BLONUMGRA001APR OF PDTRANCHE          &
         ORDERBY CIECLE,                               &
                 TRANUMTRA002,                         &
                 TRANUMTRA001

  ACCESS VIA     CIECLE                                &
         USING   T_CIECLEMNU                           &
         ORDERBY CIECLE,                               &
                 TRANUMTRA002,                         &
                 TRANUMTRA001


  ITEM CIECLE OF PDTRANCHE INITIAL T_CIECLEMNU


;-------------------------------------------------------------------------------
;
; Détail réception tranche
;

FILE PDREC_TRANCHE REFERENCE

  ACCESS VIA     CIECLE,                               &
                 TRANUMTRA002                          &
         USING   T_CIECLEMNU,                          &
                 TRANUMTRA002 OF PDTRANCHE             &
         ORDERBY CIECLE,                               &
                 RCTNUMREC,                            &
                 TRANUMTRA002

;-------------------------------------------------------------------------------
;
; Détail des caissons
;

FILE PDEMBAL_TRANCHE REFERENCE

  ACCESS VIA     CIECLE,                               &
                 TRANUMTRA002                          &
         USING   T_CIECLEMNU,                          &
                 TRANUMTRA002 OF PDTRANCHE

;-------------------------------------------------------------------------------
;
; Réception
;

FILE PDRECEPTION REFERENCE

  ACCESS VIA     CIECLE,                               &
                 RCTNUMREC                             &
         USING   T_CIECLEMNU,                          &
                 RCTNUMREC OF PDREC_TRANCHE            &
         ORDERBY CIECLE,                               &
                 RCTNUMREC,                            &
                 BCMNUMBCM


;-------------------------------------------------------------------------------
;
; Bon de commande
;

FILE PDBON_COMMANDE REFERENCE

  ACCESS VIA     CIECLE,   &
                 BCMNUMBCM &
         USING   T_CIECLEMNU, &
                 BCMNUMBCM OF PDRECEPTION


;-------------------------------------------------------------------------------
;
; Détail du bon de commande
;

FILE PDDET_BON_COMMAN REFERENCE

  ACCESS VIA     CIECLE,                         &
                 BCMNUMBCM,                      &
                 PODNUMLIG                       &
         USING   T_CIECLEMNU,                    &
                 BCMNUMBCM OF PDBON_COMMANDE,    &
                 PODNUMLIG OF PDREC_TRANCHE


;-------------------------------------------------------------------------------
;
; Fichiers de rérérence type de granit
;

FILE PDTYPE_GRANIT REFERENCE
  ACCESS VIA     CIECLE,                         &
                 TGRCODGRA                       &
         USING   T_CIECLEMNU,                    &
                 TGRCODGRA OF PDTRANCHE


;-------------------------------------------------------------------------------
;
; Fichiers de rérérence type de fini
;

FILE PDTYPE_FINI REFERENCE
  ACCESS VIA     CIECLE,                          &
                 TYFCODFIN                        &
         USING   T_CIECLEMNU,                     &
                 TYFCODFIN OF PDTRANCHE


;-------------------------------------------------------------------------------
;
; Fournisseurs
;

FILE VFOC_FOU REFERENCE
  ACCESS VIA     FOUCLE,                      &
                 FOCCIECLE,                   &
                 FOCUSISEC                    &
         USING   FOUCLE    OF PDBON_COMMANDE, &
                 T_CIECLEMNU,                 &
                 "N"


;-------------------------------------------------------------------------------
;
; Bloc
;

FILE PDBLOC REFERENCE

  ACCESS VIA     CIECLE,                               &
                 BLONUMGRA001APR,                      &
                 BLONUMGRA002APR,                      &
                 BLORECAPR                             &
         USING   T_CIECLEMNU,                          &
                 BLONUMGRA001APR OF PDTRANCHE,         &
                 BLONUMGRA002APR OF PDTRANCHE,         &
                 BLORECAPR       OF PDTRANCHE


;-------------------------------------------------------------------------------
;
; Montage bloc
;

FILE PDMONTAGE_BLOC REFERENCE

  ACCESS VIA     CIECLE,                         &
                 BLONUMGRA001APR,                &
                 BLONUMGRA002APR,                &
                 BLORECAPR                       &
         USING   T_CIECLEMNU,                    &
                 BLONUMGRA001APR OF PDTRANCHE,   &
                 BLONUMGRA002APR OF PDTRANCHE,   &
                 BLORECAPR       OF PDTRANCHE


;-------------------------------------------------------------------------------
;
; Rapport de montage
;

FILE PDRAP_MONTAGE REFERENCE

  ACCESS VIA     CIECLE,          &
                 RMSNUMSEQ        &
         USING   T_CIECLEMNU,     &
                 RMSNUMSEQ        OF PDMONTAGE_BLOC


;-------------------------------------------------------------------------------
;
; Scies
;

FILE PDSCIES REFERENCE

  ACCESS VIA     CIECLE ,                        &
                 SCINUMSCI                       &
         USING   T_CIECLEMNU,                    &
                 SCINUMSCI OF PDRAP_MONTAGE


;-------------------------------------------------------------------------------
;
; Sciage bloc
;

FILE PDSCIAGE_BLOCS REFERENCE

  ACCESS VIA     CIECLE,          &
                 RMSNUMSEQ        &
         USING   T_CIECLEMNU,     &
                 RMSNUMSEQ        OF PDMONTAGE_BLOC


;-------------------------------------------------------------------------------
;
; Sortie de tranche
;

FILE PDSORTIE_TRANCHE REFERENCE

  ACCESS VIA     CIECLE,                      &
                 TRANUMTRA002                 &
         USING   T_CIECLEMNU,                 &
                 TRANUMTRA002 OF PDTRANCHE


;-------------------------------------------------------------------------------
;
; Sortie de produits
;

FILE PDSORTIE_PRODUIT REFERENCE

  ACCESS VIA     CIECLE,                      &
                 SPRNUMSOR                    &
         USING   T_CIECLEMNU,                 &
                 SPRNUMSOR OF PDSORTIE_TRANCHE


;-------------------------------------------------------------------------------
;
; Redimension de tranche
;

FILE PDREDIM_TRANCHE  REFERENCE

  ACCESS VIA     CIECLE,                      &
                 TRANUMTRA002                 &
         USING   T_CIECLEMNU,                 &
                 TRANUMTRA002 OF PDTRANCHE


;-------------------------------------------------------------------------------
;
; Commande - assignation
;

FILE PDCOMMAN_ASSIGN REFERENCE

  ACCESS VIA     CIECLE,                      &
                 TRANUMTRA002                 &
         USING   T_CIECLEMNU,                 &
                 TRANUMTRA002 OF PDTRANCHE


;-------------------------------------------------------------------------------
;
; Détail de débitage
;

FILE PDDET_DEBITAGE REFERENCE

  ACCESS VIA     CIECLE,                      &
                 TRANUMTRA002                 &
         USING   T_CIECLEMNU,                 &
                 TRANUMTRA002 OF PDTRANCHE


;-------------------------------------------------------------------------------
;
; Débitage
;

FILE PDDEBITAGE REFERENCE

  ACCESS VIA     CIECLE,                      &
                 DEBNUMRAP                    &
         USING   T_CIECLEMNU,                 &
                 DEBNUMRAP    OF PDDET_DEBITAGE


;-------------------------------------------------------------------------------
;
; Débitage
;

FILE PDDEB_DIAGRAMME REFERENCE

  ACCESS VIA     CIECLE,                      &
                 DEBNUMRAP                    &
         USING   T_CIECLEMNU,                 &
                 DEBNUMRAP    OF PDDET_DEBITAGE


;-------------------------------------------------------------------------------
;
; Détail de rejet
;

FILE PDDET_REJET REFERENCE

  ACCESS VIA     CIECLE,                      &
                 TRANUMTRA002                 &
         USING   T_CIECLEMNU,                 &
                 TRANUMTRA002 OF PDTRANCHE


;-------------------------------------------------------------------------------
;
; Rejet
;

FILE PDREJET REFERENCE

  ACCESS VIA     CIECLE ,                     &
                 REJNUMREJ                    &
         USING   T_CIECLEMNU,                 &
                 REJNUMREJ OF PDDET_REJET


;-------------------------------------------------------------------------------
;
; Tranche facture
;

FILE PDTRANCHE_FAC REFERENCE

  ACCESS VIA     CIECLE,                      &
                 TRANUMTRA002                 &
         USING   T_CIECLEMNU,                 &
                 TRANUMTRA002 OF PDTRANCHE


;-------------------------------------------------------------------------------
;
; Facture
;

FILE PDFACTURE     REFERENCE

  ACCESS VIA     CIECLE,                       &
                 FTRNUMFAC                     &
         USING   T_CIECLEMNU,                  &
                 FTRNUMFAC OF PDTRANCHE_FAC


;-------------------------------------------------------------------------------
;
; Code bilingue (Statut)
;

FILE VCBI_DSC  REFERENCE &
               ALIAS A_CBI_TRASTU

  ACCESS VIA   XELNOM,                               &
               CBICLE                                &
         USING D_TRASTU,                             &
               TRASTU              OF PDTRANCHE



;------------------------------------------------------------------------------
; Pdetranche_retour(no. et date)
;
;

FILE PDTRANCHE_RETOUR REFERENCE

  ACCESS VIA CIECLE, &
             TRANUMTRA002 &
       USING T_CIECLEMNU ,&
             TRANUMTRA002 OF PDTRANCHE &
     ORDERBY RTONUMSEQ DESCENDING


;-------------------------------------------------------------------------------
;Pderetour (Date)

FILE PDRETOUR REFERENCE 

     ACCESS VIA CIECLE,&
               RTONUMSEQ &    
        USING  T_CIECLEMNU ,&
               RTONUMSEQ OF PDTRANCHE_RETOUR  &
       ORDERBY RTONUMSEQ DESCENDING

 
;-------------------------------------------------------------------------------
;
; Numéro et nom de la compagnie pour l'en-tête de l'écran.
;

DEFINE DZ_CIECLE CHARACTER SIZE 4 = T_CIECLEMNU
DEFINE DZ_CIENOM CHARACTER SIZE 40 = CENTER( T_CIENOM )


;-------------------------------------------------------------------------------
;
;
USE usdrwecr NOLIST ; Draw pour les écrans pleine page
USE ustitstd NOLIST ; En-tête pour les écrans pleine page
USE ushilite NOLIST ; Hilite pour tout les écrans

SKIP

TITLE &
@IF FRANCAIS
      " Tranche " &
@ELSE
      " %%%Tranche " &
@ENDIF
      CENTERED AT ,1


USE ustitoff NOLIST           ; Pour placer le TITLE OFF


SKIP TO LINE 5


ALIGN (2,3,19)


FIELD TRANUMTRA002     OF PDTRANCHE        &
label "Num. tranche..:"&
        HIDDEN ID 05                       &
        NUMERIC                            &
        BWZ


ALIGN (2,3,19)(27,28,45)(53,54,69)


FIELD TRALON           OF PDTRANCHE        &
label "Longueur......:"&
        HIDDEN ID 10    size 4                   &
        DISPLAY


FIELD TRAHAU           OF PDTRANCHE        &
label "Hauteur.......:"&
        HIDDEN ID 15   size 4                    &
        DISPLAY


FIELD TRAEPA           OF PDTRANCHE        &
label "Épaisseur.....:"&
        HIDDEN ID 20  size 4                     &
        DISPLAY


ALIGN (2,3,19) (,,25)


FIELD TGRCODGRA        OF PDTRANCHE        &
label "Code granit...:"&
        HIDDEN ID 25                       &
        NUMERIC                            &
        DISPLAY                            &
        BWZ


FIELD TGRDSCFRA001     OF PDTYPE_GRANIT    &
        DISPLAY


FIELD TYFCODFIN        OF PDTRANCHE        &
label "Code fini.....:"&
        HIDDEN ID 35                       &
        NUMERIC                            &
        DISPLAY


FIELD TYFDSCFRA001     OF PDTYPE_FINI      &
        DISPLAY


FIELD TRASTU           OF PDTRANCHE        &
label "Statut........:"&
        HIDDEN ID 45                       &
        DISPLAY


FIELD CBIDSC           OF A_CBI_TRASTU     &
        DISPLAY

FIELD TRANUMLOC        OF PDTRANCHE        &
        HIDDEN ID 47                       &
        LABEL "Localisation..:"

DRAW 11,2 TO 11,79

SKIP TO LINE 11

TITLE &
@IF FRANCAIS
      " Historique " &
@ELSE
      " %%%Historique " &
@ENDIF
      CENTERED AT ,1


SKIP TO LINE 13


ALIGN (2,3,19) (39,40,57) (61,61,62) (67,67,68)


FIELD SCBDATSCI        OF PDSCIAGE_BLOCS    FORMAT YYYYMMDD &
PATTERN "####/##/##"&
label "Date sciage...:"&
        HIDDEN ID 50                       &
        DISPLAY


FIELD BLONUMGRA001APR     OF PDTRANCHE     &
        HIDDEN ID 53                       &
        LABEL "Num. bloc.....:"            &
        NUMERIC                            &
        BWZ                                &
        DISPLAY


FIELD BLONUMGRA002APR     OF PDTRANCHE     &
        HIDDEN ID SAME                     &
        LABEL "-"                          &
        NUMERIC                            &
        BWZ                                &
        DISPLAY


FIELD BLORECAPR           OF PDTRANCHE     &
        HIDDEN ID SAME                     &
        LABEL "-"                          &
        DISPLAY


ALIGN (2,3,19) (39,40,56)


FIELD RCTDATREC        OF PDRECEPTION       FORMAT YYYYMMDD &
PATTERN "####/##/##"&
label "Date réception:"&
        HIDDEN ID 56                       &
        DISPLAY


FIELD FOUCLE           OF VFOC_FOU         &
label "Fournisseur...:"&
        HIDDEN ID 56                       &
        DISPLAY


FIELD DEBDATPRD        OF PDDEBITAGE        FORMAT YYYYMMDD &
PATTERN "####/##/##"&
label "Date product..:"&
        HIDDEN ID 58                       &
        DISPLAY


FIELD DIANUMDIA002     OF PDDEB_DIAGRAMME  &
label "No diagramme..:"&
        HIDDEN ID 60                       &
        DISPLAY


SKIP TO LINE 16


ALIGN (2,3,19) (39,40,56) (58,,59) (61,,62)


FIELD REJNUMREJ        OF PDREJET          &
label "No rejet......:"&
        HIDDEN ID 60                       &
        DISPLAY

FIELD COMNUMCOM        OF PDCOMMAN_ASSIGN  &
label "Num. commande.:"&
        HIDDEN ID 62                       &
        DISPLAY


ALIGN (2,3,19) (39,40,56)


FIELD SPRDATSOR        OF PDSORTIE_PRODUIT  FORMAT YYYYMMDD &
PATTERN "####/##/##"&
label "Date sortie...:"&
        HIDDEN ID 68                       &
        DISPLAY


FIELD OSUDATPRD        OF PDTRANCHE         FORMAT YYYYMMDD &
PATTERN "####/##/##"&
label "Date oper surf:"&
        HIDDEN ID 70                       &
        DISPLAY


FIELD RDTDATRED        OF PDREDIM_TRANCHE   FORMAT YYYYMMDD &
PATTERN "####/##/##"&
label "Date redimen..:"&
        HIDDEN ID 72                       &
        DISPLAY


FIELD FTRDATFAC        OF PDFACTURE         FORMAT YYYYMMDD &
PATTERN "####/##/##"&
label "Date facture..:"&
        HIDDEN ID 74                       &
        DISPLAY


FIELD BCMDATCRE        OF PDBON_COMMANDE    FORMAT YYYYMMDD &
PATTERN "####/##/##"&
label "Date bon cmd..:"&
        HIDDEN ID 76                       &
        DISPLAY

FIELD CAINUMCAI        OF PDEMBAL_TRANCHE  &
label "Caisson......:"&
  HIDDEN ID 78                       &
        DISPLAY


FIELD RTONUMSEQ        OF PDTRANCHE_RETOUR &
label "No. Retour....:"&
    HIDDEN ID 80     &
        DISPLAY


FIELD RTODATRET        OF PDRETOUR  FORMAT YYYYMMDD &
label "Date Retour..:"&
     HIDDEN ID 82    &
       DISPLAY


 
;-------------------------------------------------------------------------------
;
; Valide la sécurité d'accès de l'écran.
;

PROCEDURE INITIALIZE
BEGIN
  USE ussececr NOLIST
END


;-------------------------------------------------------------------------------
;
; Appel du dépisteur (pop-up) pour le champ.
;

PROCEDURE INPUT TRANUMTRA002
BEGIN
  IF 0 <> INDEX(FIELDTEXT,"*")
  THEN BEGIN
    LET T_COD          = 0 ; Toutes les tranches
    LET T_TRANUMTRA002 = FIELDTEXT[1:INDEX(FIELDTEXT,"*") - 1] + "@"
    RUN SCREEN pd122 MODE F &
                     PASSING T_TRANUMTRA002, &
                             T_COD,          &
                             T_CIECLEMNU
    LET FIELDTEXT = TRUNCATE( T_TRANUMTRA002 )
  END
END


;-------------------------------------------------------------------------------
;
;
; Valide si l'usager peut faire de la saisie.
;
;
PROCEDURE PREENTRY
BEGIN
  USE ussecent NOLIST
END


;-------------------------------------------------------------------------------
;
;
;

PROCEDURE POSTFIND
BEGIN
  LET T_FOUNO =  FOUCLE       OF VFOC_FOU
  LET T_FOUNOM = FOUNOM       OF VFOC_FOU
END


;-------------------------------------------------------------------------------
;
; Défauts de tranche
;
PROCEDURE DESIGNER D001
BEGIN
  RUN SCREEN  pd181a &
              PASSING T_CIECLEMNU,       &
                      T_CIENOM,          &
                      PDTRANCHE          &
              MODE F
END


;-------------------------------------------------------------------------------
;
; Bon de commande (P/O)
;
PROCEDURE DESIGNER D002
BEGIN
  RUN SCREEN  pd181b &
              PASSING T_CIECLEMNU,       &
                      T_CIENOM,          &
                      PDBON_COMMANDE,    &
                      PDDET_BON_COMMAN   &
              MODE F
END


;-------------------------------------------------------------------------------
;
; Réception
;
PROCEDURE DESIGNER D003
BEGIN
  IF TRACODPRD = "A"
  THEN BEGIN
    RUN SCREEN  pd181c &
                PASSING T_CIECLEMNU,        &
                        T_CIENOM,           &
                        PDRECEPTION ,       &
                        PDREC_TRANCHE       &
                MODE F
  END
  ELSE BEGIN
    WARNING 2957 ; Cette tranche n'a pas été achetée
  END
END


;-------------------------------------------------------------------------------
;
; Redimension
;

PROCEDURE DESIGNER D004
BEGIN
  RUN SCREEN  pd181d &
              PASSING T_CIECLEMNU,       &
                      T_CIENOM,          &
                      PDTRANCHE          &
              MODE F
END


;-------------------------------------------------------------------------------
;
; Sciage
;

PROCEDURE DESIGNER D005
BEGIN
  IF TRACODPRD = "P"
  THEN BEGIN
    RUN SCREEN  pd181f &
                PASSING T_CIECLEMNU,       &
                        T_CIENOM,          &
                         PDTRANCHE         &
                MODE F
  END
  ELSE BEGIN
    WARNING 2959 ; Cette tranche a été achetée
  END
END


;-------------------------------------------------------------------------------
;
; Débitage
;
PROCEDURE DESIGNER D006
BEGIN
  RUN SCREEN  pd181g &
              PASSING T_CIECLEMNU,       &
                      T_CIENOM,          &
                      PDTRANCHE          &
              MODE F
END


;-------------------------------------------------------------------------------
;
; Rejets
;
PROCEDURE DESIGNER D007
BEGIN
  RUN SCREEN  pd181h &
              PASSING T_CIECLEMNU,       &
                      T_CIENOM,          &
                      PDTRANCHE          &
              MODE F
END


;-------------------------------------------------------------------------------
;
; Sorties
;
PROCEDURE DESIGNER D008
BEGIN
  RUN SCREEN  pd181i &
              PASSING T_CIECLEMNU,       &
                      T_CIENOM,          &
                      PDTRANCHE          &
              MODE F
END



;-------------------------------------------------------------------------------
;
; Opération de surface
;
PROCEDURE DESIGNER D009
BEGIN
  RUN SCREEN  pd181j &
              PASSING T_CIECLEMNU,       &
                      T_CIENOM,          &
                      PDTRANCHE          &
              MODE F
END


;-------------------------------------------------------------------------------
;
; Facture
;
PROCEDURE DESIGNER D010
BEGIN
  RUN SCREEN  pd181k &
              PASSING T_CIECLEMNU,       &
                      T_CIENOM,          &
                      PDTRANCHE          &
              MODE F
END


;-------------------------------------------------------------------------------
;
; Vérification
;
PROCEDURE DESIGNER D011
BEGIN
  RUN SCREEN  pd181l &
              PASSING T_CIECLEMNU,       &
                      T_CIENOM,          &
                      PDTRANCHE          &
              MODE F
END


BUILD

@IF FORMAT

xxxx                xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx                   x
*********************************** Tranche ************************************
*                                                                              *
* Num. tranche..: xxxxxxx                                                      *
* Longueur......: xxxx     Hauteur.......:  xxxx     Épaisseur.....:xxxx       *
* Code granit...: xxx   xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx               *
* Code fini.....: xx    xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx               *
* Statut........: x     xxxxxxxxxxxxxxxxxxxxxxxxx                              *
* Localisation.: xxxx                                                         *
********************************** Historique **********************************
*                                                                              *
* Date sciage...: xxxxxxxx             Num. bloc.....: xxxx-xxxxx-x            *
* Date réception: xxxxxxxx             Fournisseur...: xxxxxx                  *
* Date product..: xxxxxxxx             No diagramme..: xxxxx                   *
* No rejet......: xxxxxxxxx            Num. commande.: xxxxxxxxx               *
* Date sortie...: xxxxxxxx             Date oper surf: xxxxxxxx                *
* Date redimen..: xxxxxxxx             Date facture..: xxxxxxxx                *
* Date bon cmd..: xxxxxxxx                                                     *
*                                                                              *
*                                                                              *
*                                                                              *
********************************************************************************
@ENDIF
