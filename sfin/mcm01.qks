;/T/ Menu Principal
;
;/P/ Programmeur..: Alain Côté
;    Date Création: 18 février 1992
;
;    Description..: Menu principal de l'application, c'est le premier écran
;                   du système.
;
;                   Si le Holding n'existe pas, on amène l'usager directement
;                   dans l'écran du consolidé(Holding)...
;
;/M/ François Déry, 11 mai 1999
;       Ajout de l'écran des traitement en lot.
;       Ajout du menu de gestion des blocs et facturation de bloc.
;
; /M/ Nancy Marceau, 94/02/21, Ajout module Achats & Réceptions
;                    94/05/16, Ajout module Inventaires
;
; /M/ Steeve Duguay, 94-12-15, Ajout module gestion de projets
;
;/V/ Écran vérifier pour le passage à l'an 2000
;
;/M/ Programmeur.......: Patrick Langlois
;    Date modification.: 09 Juin 1999
;    Description.......: Migration Achat/Réception/Inventaire de l'environnement (BOC)
;

SCREEN mcm01 MENU &
             STOP &
             HELP POPUP FROM 4,9 TO 20,72 &
             NOMODE NOACTION FIELDMARK RETAIN

USE mcm01.hlp NOLIST

USE ussectmp NOLIST ; Variables temporaire pour la sécurité
"MCM01"

;
; Pour les écran GHOSTS
;
TRANSACTION UPDATE READ WRITE REPEATABLE READ COMMIT ON UPDATE

;
; Pour avoir le nom du Holding.
;
FILE MCCOMPAGNIE REFERENCE
  ACCESS VIA CIENMC USING "1"

;
; On vérifie si le Holding est présent.
;
FILE MCHOLDING   DESIGNER &
                 OPEN READ


;-------------------------------------------------------------------------------
;
; Flag indiquant si le Holding est présent.
;
TEMPORARY T_FLGHLDOK CHARACTER SIZE 1 RESET AT STARTUP

DEFINE D_CIENOM CHARACTER SIZE 40 = CENTER(CIENOM OF MCCOMPAGNIE)


;-------------------------------------------------------------------------------
;
;
USE ushilite NOLIST             ; Hilite pour tout les écrans

TITLE &
@IF FRANCAIS
      " M E N U   P R I N C I P A L " &
@ELSE
      "      M A I N   M E N U      "  &
@ENDIF
      CENTERED AT 2,1


DRAW FROM 2,1  TO 2,24
DRAW FROM 2,1  TO 6,1
DRAW FROM 6,1  TO 6,80
DRAW FROM 2,80 TO 6,80
DRAW FROM 2,56 TO 2,80

DRAW FROM 1,24 TO 3,56

DRAW FROM 7,41 TO 21,41

FIELD D_CIENOM FIXED NOLABEL DATA AT 4,21

SKIP TO 8
ALIGN (7,9)
SUBSCREEN glm01 HIDDEN  &
    PASSING T_FLGHLDOK  &
@IF FRANCAIS
    LABEL "Grand Livre                    "
@ELSE
    LABEL "General Ledger                 "
@ENDIF
SKIP
DRAW ,7 TO ,41
SKIP 1


SUBSCREEN glm11 HIDDEN  &
    PASSING T_FLGHLDOK, &
            D_CIENOM    &
@IF FRANCAIS
    LABEL "Grand Livre consolidé          "
@ELSE
    LABEL "General Ledger consolidate     "
@ENDIF
SKIP
DRAW ,7 TO ,41
SKIP 1


SUBSCREEN cpm01 HIDDEN  &
    PASSING T_FLGHLDOK  &
@IF FRANCAIS
    LABEL "Comptes à payer                "
@ELSE
    LABEL "Accounts Payable               "
@ENDIF
SKIP
DRAW ,7 TO ,41
SKIP 1


SUBSCREEN crm01 HIDDEN  &
    PASSING T_FLGHLDOK  &
@IF FRANCAIS
    LABEL "Comptes à recevoir             "
@ELSE
    LABEL "Accounts Receivable            "
@ENDIF
SKIP
DRAW ,7 TO ,41
SKIP 1



;SUBSCREEN prm01 HIDDEN  &
;    PASSING T_FLGHLDOK  &
;@IF FRANCAIS
;    LABEL "Prix de revient                "
;@ELSE
;    LABEL "Project management             "
;@ENDIF
;SKIP
;DRAW ,7 TO ,41
;SKIP 1

SUBSCREEN fam01 HIDDEN  &
    PASSING T_FLGHLDOK  &
@IF FRANCAIS
    LABEL "Facturation                    "
@ELSE
    LABEL "Facturation                    "
@ENDIF
SKIP
DRAW ,7 TO ,41
SKIP 1

SUBSCREEN pdm01 HIDDEN  &
    PASSING T_FLGHLDOK  &
@IF FRANCAIS
    LABEL "Production                     "
@ELSE
    LABEL "%%%duction                     "
@ENDIF
SKIP
DRAW ,7 TO ,41
SKIP 1

SUBSCREEN arm01  HIDDEN &
    PASSING T_FLGHLDOK  &
@IF FRANCAIS
    LABEL "Achats/Réceptions/Inventaire   "
@ELSE
    LABEL "%%%Achats & Réceptions         "
@ENDIF
SKIP

SKIP TO 8

ALIGN (41,43)


;SUBSCREEN inm01  HIDDEN &
;    PASSING T_FLGHLDOK  &
;@IF FRANCAIS
;    LABEL "Inventaires                    "
;@ELSE
;    LABEL "%%%Inventaires                 "
;@ENDIF
;SKIP
;DRAW ,41 TO ,75
;SKIP 1

SUBSCREEN imm01  HIDDEN &
    PASSING T_FLGHLDOK  &
@IF FRANCAIS
    LABEL "Immobilisation                 "
@ELSE
    LABEL "%%%Immobilisation              "
@ENDIF
SKIP
DRAW ,41 TO ,75
SKIP 1


SUBSCREEN gpm01  HIDDEN &
    PASSING T_FLGHLDOK  &
@IF FRANCAIS
    LABEL "Gestion de projet              "
@ELSE
    LABEL "Project Managament             "
@ENDIF
SKIP
DRAW ,41 TO ,75
SKIP 1

SUBSCREEN igm01  HIDDEN &
    PASSING T_FLGHLDOK  &
@IF FRANCAIS
    LABEL "Inventaire physique            "
@ELSE
    LABEL "Inventaire physique            "
@ENDIF
SKIP
DRAW ,41 TO ,75
SKIP 1

SUBSCREEN ifm01  HIDDEN &
    PASSING T_FLGHLDOK  &
@IF FRANCAIS
    LABEL "Gestion de bloc                " 
@ELSE
    LABEL "%%%"
@ENDIF

SKIP
DRAW ,41 TO ,75
SKIP 1

SUBSCREEN gsm01  HIDDEN &
    PASSING T_FLGHLDOK  &
@IF FRANCAIS
    LABEL "Gestion de système             "
@ELSE
    LABEL "System Managament              "
@ENDIF
SKIP
DRAW ,41 TO ,75
SKIP 2
DRAW ,41 TO ,75

SKIP TO 22
ALIGN (25,27)

SUBSCREEN mcm02  HIDDEN &
    PASSING T_FLGHLDOK  &
@IF FRANCAIS
    LABEL "   Informations de base    "
@ELSE
    LABEL "     Basic information     "
@ENDIF
SKIP
ALIGN (25,27)
SUBSCREEN gs160 &
          HIDDEN &
          MODE F &
          LABEL "État des traitements en lot"


DRAW FROM 7,7 TO 21,75

;-------------------------------------------------------------------------------
;
; On vérifie si la définition du Holding est présente, si le Holding
; n'est pas présent on empèche l'accès à tous les menus, sauf au menu
; 'Informations de base'.
;
;
PROCEDURE INITIALIZE
BEGIN
  GET MCHOLDING VIA CIENMC USING "1" OPTIONAL
  IF NOT ACCESSOK
  THEN LET T_FLGHLDOK = "0"
  ELSE BEGIN
    LET T_FLGHLDOK = "1"
    ;
    ; Applicaton de la sécurité standard.
    ;
    USE ussececr NOLIST
  END

  IF "sylvboiv" = LOGONID and "1" = GETSYSTEMVAL("OPTMNU")
  THEN RUN SCREEN arm01 PASSING T_FLGHLDOK
  ELSE BEGIN
    IF "sylvboiv" = LOGONID and "2" = GETSYSTEMVAL("OPTMNU")
    THEN RUN SCREEN cpm01 PASSING T_FLGHLDOK
  END
END

BUILD
@IF FORMAT
                       *********************************
************************  M E N U   P R I N C I P A L  *************************
*                      *********************************                       *
*                   xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx                   *
*                                                                              *
********************************************************************************
      *********************************************************************
      * Grand Livre                     * Inventaires                     *
      *********************************************************************
      * Grand Livre consolidé           * Immobilisation                  *
      *********************************************************************
      * Comptes à payer                 * Gestion de projet               *
      *********************************************************************
      * Comptes à recevoir              * Inventaire physique             *
      *********************************************************************
      * Facturation                     * Production - gestion des blocs  *
      *********************************************************************
      * Production                      * Facturation - gestion des blocs *
      *********************************************************************
      * Achats & Réceptions             * Gestion de système              *
      *********************************************************************
                             Informations de base
                          État des traitements en lot
@ENDIF
